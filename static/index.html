<!DOCTYPE html>
<html class="dark" lang="fr">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Zen Task Dashboard</title>
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&amp;family=Inter:wght@300;400;500;600&amp;display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#D65C7C",
                        "primary-hover": "#E87C99",
                        "accent-gold": "#C8AA6E",
                        "indigo-deep": "#0F172A",
                        "indigo-card": "#1E293B",
                        "indigo-lighter": "#334155",
                        "background-light": "#F3F4F6",
                        "background-dark": "#0B1120",
                        "text-light": "#E2E8F0",
                        "text-muted": "#94A3B8"
                    },
                    fontFamily: {
                        sans: ['"Inter"', 'sans-serif'],
                        display: ['"Noto Sans JP"', 'sans-serif']
                    },
                    backgroundImage: {
                        'washi-pattern': "url('data:image/svg+xml,%3Csvg width=\\'64\\' height=\\'64\\' viewBox=\\'0 0 64 64\\' xmlns=\\'http://www.w3.org/2000/svg\\'%3E%3Cpath d=\\'M8 16c4.418 0 8-3.582 8-8s-3.582-8-8-8-8 3.582-8 8 3.582 8 8 8zm0-2c3.314 0 6-2.686 6-6s-2.686-6-6-6-6 2.686-6 6 2.686 6 6 6zm33.414-6l5.95-5.95L45.95.636 40 6.586 34.05.636 32.636 2.05 38.586 8l-5.95 5.95 1.414 1.414L40 9.414l5.95 5.95 1.414-1.414L41.414 8zM40 48c4.418 0 8-3.582 8-8s-3.582-8-8-8-8 3.582-8 8 3.582 8 8 8zm0-2c3.314 0 6-2.686 6-6s-2.686-6-6-6-6 2.686-6 6 2.686 6 6 6zM9.414 40l5.95-5.95-1.414-1.414L8 38.586l-5.95-5.95L.636 34.05 6.586 40l-5.95 5.95 1.414 1.414L8 41.414l5.95 5.95 1.414-1.414L9.414 40z\\' fill=\\'%239C92AC\\' fill-opacity=\\'0.03\\' fill-rule=\\'evenodd\\'/%3E%3C/svg%3E')"
                    }
                }
            }
        };
    </script>
    <style>
        :root {
            --bg-primary: #0B1120;
            --bg-secondary: #1E293B;
            --bg-card: #334155;
            --text-primary: #E2E8F0;
            --text-secondary: #94A3B8;
            --accent-primary: #D65C7C;
            --accent-green: #10B981;
            --accent-orange: #F59E0B;
            --accent-red: #EF4444;
            --border-color: #334155;
        }

        .glass-panel {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .japanese-border-bottom {
            position: relative;
        }

        .japanese-border-bottom::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(214, 92, 124, 0.5), transparent);
        }

        .category-item.active {
            background: rgba(51, 65, 85, 0.5);
            border-left-color: var(--accent-primary);
            color: var(--accent-primary);
        }

        .filter-tab.active {
            background: rgba(255, 255, 255, 0.95);
            color: #0f172a;
            box-shadow: 0 6px 18px rgba(15, 23, 42, 0.15);
        }

        .dark .filter-tab.active {
            background: rgba(51, 65, 85, 0.7);
            color: #ffffff;
            box-shadow: 0 8px 18px rgba(10, 15, 25, 0.35);
        }

        .todo-item {
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid rgba(148, 163, 184, 0.12);
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.95rem 1.1rem;
            transition: all 0.2s ease;
        }

        .todo-item:hover {
            border-color: rgba(214, 92, 124, 0.45);
            transform: translateY(-2px);
        }

        .todo-item.completed {
            opacity: 0.6;
        }

        .todo-item.completed .todo-title {
            text-decoration: line-through;
        }

        .todo-checkbox {
            width: 22px;
            height: 22px;
            border-radius: 6px;
            border: 2px solid rgba(148, 163, 184, 0.5);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            transition: all 0.2s ease;
        }

        .todo-checkbox:hover {
            border-color: var(--accent-green);
        }

        .todo-checkbox.checked {
            background: var(--accent-green);
            border-color: var(--accent-green);
        }

        .todo-checkbox.checked::after {
            content: '‚úì';
            color: white;
            font-size: 0.75rem;
            font-weight: bold;
        }

        .todo-content {
            flex: 1;
        }

        .todo-title {
            font-weight: 500;
            margin-bottom: 0.25rem;
            color: var(--text-primary);
        }

        .todo-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .todo-meta span {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
        }

        .priority-badge {
            padding: 0.2rem 0.6rem;
            border-radius: 999px;
            font-size: 0.65rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.06em;
            border: 1px solid transparent;
        }

        .priority-urgent {
            background: rgba(239, 68, 68, 0.15);
            color: #f87171;
            border-color: rgba(239, 68, 68, 0.35);
        }

        .priority-important {
            background: rgba(245, 158, 11, 0.15);
            color: #fbbf24;
            border-color: rgba(245, 158, 11, 0.35);
        }

        .priority-normal {
            background: rgba(148, 163, 184, 0.2);
            color: var(--text-secondary);
            border-color: rgba(148, 163, 184, 0.35);
        }

        .todo-actions {
            display: flex;
            gap: 0.4rem;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .todo-item:hover .todo-actions {
            opacity: 1;
        }

        .action-btn {
            width: 30px;
            height: 30px;
            border-radius: 8px;
            border: 1px solid rgba(148, 163, 184, 0.2);
            background: rgba(15, 23, 42, 0.35);
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .action-btn:hover {
            background: rgba(214, 92, 124, 0.2);
            color: #f8fafc;
            border-color: rgba(214, 92, 124, 0.4);
        }

        .action-btn.delete:hover {
            background: rgba(239, 68, 68, 0.25);
            border-color: rgba(239, 68, 68, 0.5);
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(11, 17, 32, 0.75);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            padding: 1.5rem;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: rgba(30, 41, 59, 0.95);
            padding: 2rem;
            border-radius: 18px;
            width: 100%;
            max-width: 520px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 24px 60px rgba(5, 10, 20, 0.45);
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }

        .modal-overlay.active .modal {
            transform: translateY(0);
        }

        .modal h2 {
            margin-bottom: 1.5rem;
            font-size: 1.25rem;
        }

        .form-group {
            margin-bottom: 1.25rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border-radius: 10px;
            border: 1px solid rgba(148, 163, 184, 0.25);
            background: rgba(15, 23, 42, 0.6);
            color: var(--text-primary);
            font-size: 0.95rem;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 2px rgba(214, 92, 124, 0.2);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 0.75rem;
            margin-top: 1.5rem;
        }

        @media (max-width: 640px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }

        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: #0f172a;
        }

        ::-webkit-scrollbar-thumb {
            background: #334155;
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #475569;
        }

        .todo-description {
            margin-top: 0.5rem;
            padding: 0.75rem;
            background: rgba(100, 116, 139, 0.1);
            border-left: 3px solid var(--accent-primary);
            border-radius: 6px;
            font-size: 0.8rem;
            line-height: 1.6;
            color: var(--text-secondary);
            white-space: pre-line;
        }

        .todo-description strong {
            color: var(--text-primary);
        }
    </style>
</head>

<body
    class="bg-gray-100 dark:bg-background-dark text-gray-800 dark:text-text-light font-sans min-h-screen transition-colors duration-300 relative overflow-x-hidden">
    <div class="fixed top-0 left-0 w-full h-full pointer-events-none z-0 opacity-20 dark:opacity-10 bg-washi-pattern">
    </div>
    <div
        class="fixed -top-32 -right-32 w-96 h-96 bg-primary rounded-full filter blur-[120px] opacity-10 dark:opacity-20 z-0">
    </div>
    <div
        class="fixed top-1/2 -left-32 w-80 h-80 bg-blue-500 rounded-full filter blur-[100px] opacity-10 dark:opacity-10 z-0">
    </div>
    <div class="relative z-10 max-w-7xl mx-auto p-4 md:p-8 space-y-8" id="top">
        <header
            class="flex flex-col md:flex-row justify-between items-start md:items-center japanese-border-bottom pb-6 gap-4">
            <div>
                <div class="flex items-center gap-3">
                    <span class="text-3xl">üåô</span>
                    <h1
                        class="text-3xl md:text-4xl font-display font-light tracking-wide text-gray-900 dark:text-white">
                        Alex <span class="text-primary font-normal">Todo</span> Dashboard
                    </h1>
                </div>
                <p class="text-sm text-gray-500 dark:text-text-muted mt-1 ml-1 font-display tracking-widest uppercase text-xs"
                    id="currentDate"></p>
            </div>
            <div class="flex items-center gap-3">
                <button type="button"
                    class="flex items-center gap-2 px-4 py-2 rounded-lg bg-gray-200 dark:bg-indigo-lighter/50 hover:bg-gray-300 dark:hover:bg-indigo-lighter transition-all text-sm font-medium border border-gray-300 dark:border-white/5 shadow-sm text-gray-700 dark:text-gray-200"
                    onclick="sendDailySummary()">
                    <span class="material-icons-round text-base text-blue-400">bar_chart</span>
                    R√©sum√© Telegram
                </button>
                <button type="button"
                    class="flex items-center gap-2 px-5 py-2 rounded-lg bg-primary hover:bg-primary-hover transition-all text-sm font-semibold text-white shadow-lg shadow-primary/20"
                    onclick="openModal()">
                    <span class="material-icons-round text-base">add</span>
                    Nouvelle t√¢che
                </button>
            </div>
        </header>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4" id="section-stats">
            <div
                class="glass-panel p-5 rounded-xl flex flex-col justify-between hover:translate-y-[-2px] transition-transform duration-300 group cursor-default bg-white dark:bg-indigo-card shadow-sm dark:shadow-none">
                <h3 class="text-xs font-bold tracking-widest text-gray-500 dark:text-gray-400 uppercase mb-2">Total
                    T√¢ches</h3>
                <div class="flex items-end justify-between">
                    <span class="text-4xl font-display font-light text-gray-900 dark:text-white" id="statTotal">0</span>
                    <span
                        class="material-icons-round text-primary/20 text-4xl group-hover:text-primary/40 transition-colors">list_alt</span>
                </div>
            </div>
            <div
                class="glass-panel p-5 rounded-xl flex flex-col justify-between hover:translate-y-[-2px] transition-transform duration-300 group cursor-default bg-white dark:bg-indigo-card shadow-sm dark:shadow-none">
                <h3 class="text-xs font-bold tracking-widest text-gray-500 dark:text-gray-400 uppercase mb-2">En Attente
                </h3>
                <div class="flex items-end justify-between">
                    <span class="text-4xl font-display font-light text-amber-500" id="statPending">0</span>
                    <span
                        class="material-icons-round text-amber-500/20 text-4xl group-hover:text-amber-500/40 transition-colors">hourglass_empty</span>
                </div>
            </div>
            <div
                class="glass-panel p-5 rounded-xl flex flex-col justify-between hover:translate-y-[-2px] transition-transform duration-300 group cursor-default bg-white dark:bg-indigo-card shadow-sm dark:shadow-none">
                <h3 class="text-xs font-bold tracking-widest text-gray-500 dark:text-gray-400 uppercase mb-2">Compl√©t√©es
                </h3>
                <div class="flex items-end justify-between">
                    <span class="text-4xl font-display font-light text-emerald-500" id="statCompleted">0</span>
                    <span
                        class="material-icons-round text-emerald-500/20 text-4xl group-hover:text-emerald-500/40 transition-colors">check_circle</span>
                </div>
            </div>
            <div
                class="glass-panel p-5 rounded-xl flex flex-col justify-between hover:translate-y-[-2px] transition-transform duration-300 group cursor-default bg-white dark:bg-indigo-card shadow-sm dark:shadow-none">
                <h3 class="text-xs font-bold tracking-widest text-gray-500 dark:text-gray-400 uppercase mb-2">En Retard
                </h3>
                <div class="flex items-end justify-between">
                    <span class="text-4xl font-display font-light text-red-500" id="statOverdue">0</span>
                    <span
                        class="material-icons-round text-red-500/20 text-4xl group-hover:text-red-500/40 transition-colors">warning</span>
                </div>
            </div>
            <div
                class="glass-panel p-5 rounded-xl flex flex-col justify-between hover:translate-y-[-2px] transition-transform duration-300 group cursor-default bg-white dark:bg-indigo-card shadow-sm dark:shadow-none">
                <h3 class="text-xs font-bold tracking-widest text-gray-500 dark:text-gray-400 uppercase mb-2">
                    Aujourd'hui</h3>
                <div class="flex items-end justify-between">
                    <span class="text-4xl font-display font-light text-gray-900 dark:text-white" id="statToday">0</span>
                    <span
                        class="material-icons-round text-blue-400/20 text-4xl group-hover:text-blue-400/40 transition-colors">today</span>
                </div>
            </div>
        </div>
        <div class="glass-panel p-6 rounded-xl bg-white dark:bg-indigo-card shadow-sm dark:shadow-none border border-gray-200 dark:border-white/5"
            id="section-progress">
            <div class="flex justify-between items-center mb-3">
                <span class="text-sm font-medium text-gray-600 dark:text-gray-300">Progression globale</span>
                <span class="text-sm font-bold text-primary" id="progressPercent">0%</span>
            </div>
            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 overflow-hidden">
                <div class="bg-primary h-2.5 rounded-full w-0 shadow-[0_0_10px_rgba(214,92,124,0.5)]" id="progressFill"
                    style="width: 0%"></div>
            </div>
        </div>

        <!-- Citation & Fait du jour -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="section-daily">
            <div
                class="glass-panel p-5 rounded-xl bg-gradient-to-br from-purple-500/10 to-pink-500/10 dark:from-purple-900/20 dark:to-pink-900/20 border border-purple-200/30 dark:border-purple-500/20 hover:translate-y-[-2px] transition-transform duration-300">
                <div class="flex items-start justify-between mb-3">
                    <div class="flex items-center gap-2">
                        <span class="text-2xl">üí≠</span>
                        <h3 class="text-xs font-bold tracking-widest text-purple-600 dark:text-purple-400 uppercase">
                            Citation du jour</h3>
                    </div>
                    <button type="button" class="text-purple-400 hover:text-purple-300 transition-colors"
                        onclick="refreshDailyContent()" title="Reg√©n√©rer">
                        <span class="material-icons-round text-lg">refresh</span>
                    </button>
                </div>
                <blockquote class="text-gray-700 dark:text-gray-200 italic text-sm leading-relaxed mb-2"
                    id="dailyQuote">"Chargement..."</blockquote>
                <p class="text-xs text-purple-500 dark:text-purple-400 font-medium" id="dailyQuoteAuthor">‚Äî ...</p>
            </div>
            <div
                class="glass-panel p-5 rounded-xl bg-gradient-to-br from-blue-500/10 to-cyan-500/10 dark:from-blue-900/20 dark:to-cyan-900/20 border border-blue-200/30 dark:border-blue-500/20 hover:translate-y-[-2px] transition-transform duration-300">
                <div class="flex items-center gap-2 mb-3">
                    <span class="text-2xl">üí°</span>
                    <h3 class="text-xs font-bold tracking-widest text-blue-600 dark:text-blue-400 uppercase">Le
                        saviez-vous ?</h3>
                </div>
                <p class="text-gray-700 dark:text-gray-200 text-sm leading-relaxed" id="dailyFunFact">Chargement...</p>
            </div>
        </div>

        <!-- Roadmap Section -->
        <div class="glass-panel rounded-xl bg-white dark:bg-indigo-card shadow-sm dark:shadow-none border border-gray-200 dark:border-white/5"
            id="section-roadmap">
            <div
                class="p-6 border-b border-gray-200 dark:border-white/5 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                <div class="flex items-center gap-3">
                    <span class="text-2xl">üó∫Ô∏è</span>
                    <h2 class="text-xl font-display font-medium text-gray-800 dark:text-white">Roadmap</h2>
                </div>
                <div class="flex items-center gap-3">
                    <div class="flex p-1 bg-gray-100 dark:bg-indigo-lighter/30 rounded-lg">
                        <button type="button"
                            class="roadmap-tab px-4 py-1.5 rounded-md text-xs font-medium transition-all active"
                            data-type="mid_term">Mi-terme (3-6 mois)</button>
                        <button type="button"
                            class="roadmap-tab px-4 py-1.5 rounded-md text-xs font-medium text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-all"
                            data-type="long_term">Long-terme (6+ mois)</button>
                    </div>
                    <button type="button"
                        class="flex items-center gap-2 px-4 py-2 rounded-lg bg-primary hover:bg-primary-hover transition-all text-sm font-semibold text-white shadow-lg shadow-primary/20"
                        onclick="openRoadmapModal()">
                        <span class="material-icons-round text-base">add</span>
                        Objectif
                    </button>
                </div>
            </div>
            <div class="p-6 min-h-[200px]" id="roadmapContent">
                <div class="flex flex-col items-center justify-center h-40 text-center">
                    <span class="text-4xl mb-3 animate-pulse">üéØ</span>
                    <p class="text-sm text-gray-500 dark:text-gray-400">Aucun objectif d√©fini. Ajoutez votre premier
                        objectif!</p>
                </div>
            </div>
        </div>

        <!-- Analytics & Habits Row -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6" id="section-analytics">
            <!-- Graphique Productivit√© -->
            <div
                class="glass-panel rounded-xl bg-white dark:bg-indigo-card shadow-sm dark:shadow-none border border-gray-200 dark:border-white/5 p-6">
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center gap-2">
                        <span class="text-2xl">üìä</span>
                        <h3 class="text-sm font-bold tracking-widest text-gray-600 dark:text-gray-300 uppercase">
                            Productivit√©</h3>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="text-xs text-emerald-500 font-semibold" id="streakBadge">üî• 0 jours</span>
                    </div>
                </div>
                <div class="relative h-48 w-full">
                    <canvas id="productivityChart"></canvas>
                </div>
                <div class="flex justify-between mt-4 text-xs text-gray-500 dark:text-gray-400">
                    <span>Meilleur jour: <strong id="bestDayLabel">-</strong></span>
                    <span>Cette semaine: <strong id="weeklyTotal">0</strong> t√¢ches</span>
                </div>
            </div>

            <!-- Habitudes Tracker -->
            <div
                class="glass-panel rounded-xl bg-white dark:bg-indigo-card shadow-sm dark:shadow-none border border-gray-200 dark:border-white/5 p-6">
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center gap-2">
                        <span class="text-2xl">‚úÖ</span>
                        <h3 class="text-sm font-bold tracking-widest text-gray-600 dark:text-gray-300 uppercase">
                            Habitudes</h3>
                    </div>
                    <button type="button" onclick="openHabitModal()"
                        class="flex items-center gap-1 px-3 py-1.5 rounded-lg bg-emerald-500/10 hover:bg-emerald-500/20 text-emerald-600 dark:text-emerald-400 text-xs font-medium transition-all">
                        <span class="material-icons-round text-sm">add</span>
                        Ajouter
                    </button>
                </div>
                <div id="habitsContainer" class="space-y-3">
                    <div class="text-center py-8 text-gray-400 dark:text-gray-500">
                        <span class="text-3xl mb-2 block">üéØ</span>
                        <p class="text-sm">Aucune habitude d√©finie</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Vue Ma Journ√©e & Mini Calendrier -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6" id="section-today">
            <!-- Ma Journ√©e -->
            <div
                class="lg:col-span-2 glass-panel rounded-xl bg-white dark:bg-indigo-card shadow-sm dark:shadow-none border border-gray-200 dark:border-white/5 p-6">
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center gap-2">
                        <span class="text-2xl">‚òÄÔ∏è</span>
                        <h3 class="text-sm font-bold tracking-widest text-gray-600 dark:text-gray-300 uppercase">Ma
                            Journ√©e</h3>
                    </div>
                    <span class="text-xs text-gray-500 dark:text-gray-400" id="todayTaskCount">0 t√¢ches
                        prioritaires</span>
                </div>
                <div id="todayTasksContainer" class="space-y-2">
                    <div class="text-center py-8 text-gray-400 dark:text-gray-500">
                        <span class="text-3xl mb-2 block">üåÖ</span>
                        <p class="text-sm">Aucune t√¢che urgente pour aujourd'hui</p>
                    </div>
                </div>
            </div>

            <!-- Mini Calendrier -->
            <div
                class="glass-panel rounded-xl bg-white dark:bg-indigo-card shadow-sm dark:shadow-none border border-gray-200 dark:border-white/5 p-6">
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center gap-2">
                        <span class="text-2xl">üóìÔ∏è</span>
                        <h3 class="text-sm font-bold tracking-widest text-gray-600 dark:text-gray-300 uppercase">
                            Calendrier</h3>
                    </div>
                    <div class="flex items-center gap-1">
                        <button type="button" onclick="changeMonth(-1)"
                            class="p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                            <span class="material-icons-round text-sm text-gray-500">chevron_left</span>
                        </button>
                        <span id="calendarMonthLabel"
                            class="text-xs font-medium text-gray-600 dark:text-gray-300 min-w-[80px] text-center">Jan
                            2026</span>
                        <button type="button" onclick="changeMonth(1)"
                            class="p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                            <span class="material-icons-round text-sm text-gray-500">chevron_right</span>
                        </button>
                    </div>
                </div>
                <div id="miniCalendar" class="grid grid-cols-7 gap-1 text-center">
                    <div class="text-xs font-medium text-gray-400 py-1">L</div>
                    <div class="text-xs font-medium text-gray-400 py-1">M</div>
                    <div class="text-xs font-medium text-gray-400 py-1">M</div>
                    <div class="text-xs font-medium text-gray-400 py-1">J</div>
                    <div class="text-xs font-medium text-gray-400 py-1">V</div>
                    <div class="text-xs font-medium text-gray-400 py-1">S</div>
                    <div class="text-xs font-medium text-gray-400 py-1">D</div>
                </div>
                <div id="calendarDays" class="grid grid-cols-7 gap-1 mt-1"></div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6 min-h-[500px]">
            <aside
                class="glass-panel rounded-xl p-4 lg:col-span-1 bg-white dark:bg-indigo-card shadow-sm dark:shadow-none h-full border border-gray-200 dark:border-white/5">
                <h2 class="text-xs font-bold tracking-widest text-gray-500 dark:text-gray-400 uppercase mb-4 px-2">
                    Cat√©gories</h2>
                <nav class="space-y-1">
                    <button type="button"
                        class="category-item active flex items-center justify-between px-3 py-3 rounded-lg text-gray-700 dark:text-gray-300 border-l-4 border-transparent transition-all group"
                        data-category="all">
                        <div class="flex items-center gap-3">
                            <span class="text-lg opacity-80 group-hover:scale-110 transition-transform">‚õ©Ô∏è</span>
                            <span class="font-medium text-sm">Toutes</span>
                        </div>
                        <span
                            class="text-xs font-bold bg-gray-200 dark:bg-gray-700 px-2 py-0.5 rounded-full text-gray-500 dark:text-gray-400"
                            id="countAll">0</span>
                    </button>
                    <button type="button"
                        class="category-item flex items-center justify-between px-3 py-3 rounded-lg hover:bg-gray-50 dark:hover:bg-indigo-lighter/30 text-gray-700 dark:text-gray-300 border-l-4 border-transparent hover:border-blue-400 transition-all group"
                        data-category="easynode">
                        <div class="flex items-center gap-3">
                            <span
                                class="material-icons-round text-blue-400 text-lg group-hover:scale-110 transition-transform">rocket_launch</span>
                            <span class="font-medium text-sm">EasyNode</span>
                        </div>
                        <span
                            class="text-xs font-bold bg-gray-200 dark:bg-gray-700 px-2 py-0.5 rounded-full text-gray-500 dark:text-gray-400"
                            id="countEasynode">0</span>
                    </button>
                    <button type="button"
                        class="category-item flex items-center justify-between px-3 py-3 rounded-lg hover:bg-gray-50 dark:hover:bg-indigo-lighter/30 text-gray-700 dark:text-gray-300 border-l-4 border-transparent hover:border-emerald-400 transition-all group"
                        data-category="immobilier">
                        <div class="flex items-center gap-3">
                            <span class="text-lg group-hover:scale-110 transition-transform">üèØ</span>
                            <span class="font-medium text-sm">Immobilier</span>
                        </div>
                        <span
                            class="text-xs font-bold bg-gray-200 dark:bg-gray-700 px-2 py-0.5 rounded-full text-gray-500 dark:text-gray-400"
                            id="countImmobilier">0</span>
                    </button>
                    <button type="button"
                        class="category-item flex items-center justify-between px-3 py-3 rounded-lg hover:bg-gray-50 dark:hover:bg-indigo-lighter/30 text-gray-700 dark:text-gray-300 border-l-4 border-transparent hover:border-purple-400 transition-all group"
                        data-category="content">
                        <div class="flex items-center gap-3">
                            <span
                                class="material-icons-round text-purple-400 text-lg group-hover:scale-110 transition-transform">smartphone</span>
                            <span class="font-medium text-sm">Content</span>
                        </div>
                        <span
                            class="text-xs font-bold bg-gray-200 dark:bg-gray-700 px-2 py-0.5 rounded-full text-gray-500 dark:text-gray-400"
                            id="countContent">0</span>
                    </button>
                    <button type="button"
                        class="category-item flex items-center justify-between px-3 py-3 rounded-lg hover:bg-gray-50 dark:hover:bg-indigo-lighter/30 text-gray-700 dark:text-gray-300 border-l-4 border-transparent hover:border-pink-300 transition-all group"
                        data-category="personnel">
                        <div class="flex items-center gap-3">
                            <span class="text-lg group-hover:scale-110 transition-transform">üéã</span>
                            <span class="font-medium text-sm">Personnel</span>
                        </div>
                        <span
                            class="text-xs font-bold bg-gray-200 dark:bg-gray-700 px-2 py-0.5 rounded-full text-gray-500 dark:text-gray-400"
                            id="countPersonnel">0</span>
                    </button>
                    <button type="button"
                        class="category-item flex items-center justify-between px-3 py-3 rounded-lg hover:bg-gray-50 dark:hover:bg-indigo-lighter/30 text-gray-700 dark:text-gray-300 border-l-4 border-transparent hover:border-gray-400 transition-all group"
                        data-category="admin">
                        <div class="flex items-center gap-3">
                            <span
                                class="material-icons-round text-gray-400 text-lg group-hover:scale-110 transition-transform">description</span>
                            <span class="font-medium text-sm">Admin</span>
                        </div>
                        <span
                            class="text-xs font-bold bg-gray-200 dark:bg-gray-700 px-2 py-0.5 rounded-full text-gray-500 dark:text-gray-400"
                            id="countAdmin">0</span>
                    </button>
                </nav>
                <div class="mt-6 border-t border-gray-200 dark:border-white/5 pt-4">
                    <h3 class="text-xs font-bold tracking-widest text-gray-500 dark:text-gray-400 uppercase mb-3 px-2">
                        Liens utiles</h3>
                    <div class="space-y-2">
                        <a class="flex items-center justify-between px-3 py-2 rounded-lg text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-indigo-lighter/30 transition-all"
                            href="#section-stats">Statistiques</a>
                        <a class="flex items-center justify-between px-3 py-2 rounded-lg text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-indigo-lighter/30 transition-all"
                            href="#section-progress">Progression</a>
                        <a class="flex items-center justify-between px-3 py-2 rounded-lg text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-indigo-lighter/30 transition-all"
                            href="#section-tasks">T√¢ches</a>
                        <a class="flex items-center justify-between px-3 py-2 rounded-lg text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-indigo-lighter/30 transition-all"
                            href="#section-add">Ajout rapide</a>
                    </div>
                </div>
            </aside>
            <main
                class="glass-panel rounded-xl lg:col-span-3 bg-white dark:bg-indigo-card shadow-sm dark:shadow-none flex flex-col border border-gray-200 dark:border-white/5 relative overflow-hidden"
                id="section-tasks">
                <div class="absolute inset-0 opacity-[0.03] dark:opacity-[0.05] pointer-events-none"
                    style="background-image: radial-gradient(circle, #999 1px, transparent 1px); background-size: 20px 20px;">
                </div>
                <div
                    class="p-6 border-b border-gray-200 dark:border-white/5 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 relative z-10">
                    <h2 class="text-xl font-display font-medium text-gray-800 dark:text-white" id="sectionTitle">Toutes
                        les t√¢ches</h2>
                    <div class="flex p-1 bg-gray-100 dark:bg-indigo-lighter/30 rounded-lg">
                        <button type="button"
                            class="filter-tab px-4 py-1.5 rounded-md text-xs font-medium transition-all active"
                            data-status="all">Toutes</button>
                        <button type="button"
                            class="filter-tab px-4 py-1.5 rounded-md text-xs font-medium text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-all"
                            data-status="pending">En attente</button>
                        <button type="button"
                            class="filter-tab px-4 py-1.5 rounded-md text-xs font-medium text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-all"
                            data-status="completed">Termin√©es</button>
                    </div>
                </div>
                <div class="p-6 flex-grow relative z-10">
                    <div class="flex gap-2 mb-10" id="section-add">
                        <div class="relative flex-grow">
                            <input
                                class="w-full bg-gray-50 dark:bg-indigo-lighter/20 border border-gray-200 dark:border-white/10 rounded-lg py-3 px-4 text-sm text-gray-800 dark:text-gray-200 placeholder-gray-400 dark:placeholder-gray-500 focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all"
                                placeholder="Ajouter rapidement une t√¢che... (Entr√©e pour valider)" type="text"
                                id="quickAddInput" />
                        </div>
                        <button type="button"
                            class="bg-primary hover:bg-primary-hover text-white rounded-lg px-4 flex items-center justify-center transition-colors shadow-lg shadow-primary/20"
                            onclick="quickAdd()">
                            <span class="material-icons-round">add</span>
                        </button>
                    </div>
                    <div class="space-y-3" id="todoList">
                        <div class="flex flex-col items-center justify-center h-64 text-center mt-4">
                            <div class="relative mb-6">
                                <div
                                    class="w-32 h-32 rounded-full bg-gradient-to-b from-transparent to-gray-100 dark:to-indigo-lighter/10 flex items-center justify-center">
                                    <span class="text-6xl drop-shadow-xl animate-pulse">üóª</span>
                                </div>
                                <div class="absolute -top-2 right-0 text-xl animate-bounce"
                                    style="animation-duration: 3s;">üå∏</div>
                                <div class="absolute top-10 -left-4 text-lg animate-bounce"
                                    style="animation-duration: 4s; animation-delay: 1s;">üå∏</div>
                            </div>
                            <h3 class="text-lg font-display font-medium text-gray-700 dark:text-gray-200 mb-1">Aucune
                                t√¢che ici!</h3>
                            <p class="text-sm text-gray-500 dark:text-gray-400 max-w-xs mx-auto">
                                L'esprit est clair comme l'eau calme.<br />Profitez de ce moment de s√©r√©nit√©.
                            </p>
                        </div>
                    </div>
                </div>
                <div class="h-1 w-full bg-gradient-to-r from-transparent via-primary/30 to-transparent"></div>
            </main>
        </div>
    </div>

    <div class="modal-overlay" id="modalOverlay">
        <div class="modal">
            <h2 class="font-display" id="modalTitle">Nouvelle t√¢che</h2>
            <form id="todoForm">
                <input type="hidden" id="todoId" />
                <div class="form-group">
                    <label for="todoTitle">Titre</label>
                    <input type="text" id="todoTitle" required placeholder="Ex: Finir le script LLM" />
                </div>
                <div class="form-group">
                    <label for="todoDescription">Description (optionnel)</label>
                    <textarea id="todoDescription" rows="2" placeholder="D√©tails suppl√©mentaires..."></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="todoCategory">Cat√©gorie</label>
                        <select id="todoCategory">
                            <option value="easynode">üöÄ EasyNode</option>
                            <option value="immobilier">üèØ Immobilier</option>
                            <option value="content">üì± Content</option>
                            <option value="personnel">üéã Personnel</option>
                            <option value="admin">üìÑ Admin</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="todoPriority">Priorit√©</label>
                        <select id="todoPriority">
                            <option value="normal">üü° Normal</option>
                            <option value="important">üü† Important</option>
                            <option value="urgent">üî¥ Urgent</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="todoDeadline">Deadline (optionnel)</label>
                    <input type="datetime-local" id="todoDeadline" />
                </div>
                <div class="modal-actions">
                    <button type="button"
                        class="flex items-center gap-2 px-4 py-2 rounded-lg bg-gray-200 dark:bg-indigo-lighter/40 hover:bg-gray-300 dark:hover:bg-indigo-lighter transition-all text-sm font-medium text-gray-700 dark:text-gray-200"
                        onclick="closeModal()">Annuler</button>
                    <button type="submit"
                        class="flex items-center gap-2 px-5 py-2 rounded-lg bg-primary hover:bg-primary-hover transition-all text-sm font-semibold text-white shadow-lg shadow-primary/20">Enregistrer</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Roadmap -->
    <div class="modal-overlay" id="roadmapModalOverlay">
        <div class="modal">
            <h2 class="font-display" id="roadmapModalTitle">Nouvel objectif</h2>
            <form id="roadmapForm">
                <input type="hidden" id="roadmapItemId" />
                <div class="form-group">
                    <label for="roadmapTitle">Titre</label>
                    <input type="text" id="roadmapTitle" required placeholder="Ex: Lancer EasyNode v2.0" />
                </div>
                <div class="form-group">
                    <label for="roadmapDescription">Description (optionnel)</label>
                    <textarea id="roadmapDescription" rows="2" placeholder="D√©tails sur cet objectif..."></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="roadmapType">Type</label>
                        <select id="roadmapType">
                            <option value="mid_term">üìÖ Mi-terme (3-6 mois)</option>
                            <option value="long_term">üéØ Long-terme (6+ mois)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="roadmapStatus">Statut</label>
                        <select id="roadmapStatus">
                            <option value="not_started">‚è≥ Non d√©marr√©</option>
                            <option value="in_progress">üîÑ En cours</option>
                            <option value="completed">‚úÖ Termin√©</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="roadmapTargetDate">Date cible</label>
                    <input type="date" id="roadmapTargetDate" />
                </div>
                <div class="modal-actions">
                    <button type="button"
                        class="flex items-center gap-2 px-4 py-2 rounded-lg bg-gray-200 dark:bg-indigo-lighter/40 hover:bg-gray-300 dark:hover:bg-indigo-lighter transition-all text-sm font-medium text-gray-700 dark:text-gray-200"
                        onclick="closeRoadmapModal()">Annuler</button>
                    <button type="submit"
                        class="flex items-center gap-2 px-5 py-2 rounded-lg bg-primary hover:bg-primary-hover transition-all text-sm font-semibold text-white shadow-lg shadow-primary/20">Enregistrer</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Habit -->
    <div class="modal-overlay" id="habitModalOverlay">
        <div class="modal">
            <h2 class="font-display">Nouvelle habitude</h2>
            <form id="habitForm">
                <div class="form-group">
                    <label for="habitName">Nom de l'habitude</label>
                    <input type="text" id="habitName" required placeholder="Ex: M√©ditation 10 min" />
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="habitEmoji">Emoji</label>
                        <select id="habitEmoji">
                            <option value="‚úÖ">‚úÖ Check</option>
                            <option value="üßò">üßò M√©ditation</option>
                            <option value="üìö">üìö Lecture</option>
                            <option value="üí™">üí™ Sport</option>
                            <option value="üíß">üíß Eau</option>
                            <option value="ü•ó">ü•ó Alimentation</option>
                            <option value="üí§">üí§ Sommeil</option>
                            <option value="üìù">üìù Journal</option>
                            <option value="üéØ">üéØ Objectif</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="habitColor">Couleur</label>
                        <select id="habitColor">
                            <option value="#10b981">üü¢ Vert</option>
                            <option value="#3b82f6">üîµ Bleu</option>
                            <option value="#8b5cf6">üü£ Violet</option>
                            <option value="#f59e0b">üü† Orange</option>
                            <option value="#ef4444">üî¥ Rouge</option>
                            <option value="#ec4899">ü©∑ Rose</option>
                        </select>
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button"
                        class="flex items-center gap-2 px-4 py-2 rounded-lg bg-gray-200 dark:bg-indigo-lighter/40 hover:bg-gray-300 dark:hover:bg-indigo-lighter transition-all text-sm font-medium text-gray-700 dark:text-gray-200"
                        onclick="closeHabitModal()">Annuler</button>
                    <button type="submit"
                        class="flex items-center gap-2 px-5 py-2 rounded-lg bg-emerald-500 hover:bg-emerald-600 transition-all text-sm font-semibold text-white shadow-lg shadow-emerald-500/20">Cr√©er</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // State
        let todos = [];
        let roadmapItems = [];
        let currentRoadmapType = 'mid_term';
        let currentFilter = { status: 'all', category: 'all' };

        // API Base URL
        const API_URL = '';

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            updateDate();
            loadTodos();
            loadStats();
            loadDailyContent();
            loadRoadmap();
            setupEventListeners();
        });

        function updateDate() {
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('currentDate').textContent =
                new Date().toLocaleDateString('fr-FR', options);
        }

        function setupEventListeners() {
            // Category filters
            document.querySelectorAll('.category-item').forEach(item => {
                item.addEventListener('click', () => {
                    document.querySelectorAll('.category-item').forEach(i => i.classList.remove('active'));
                    item.classList.add('active');
                    currentFilter.category = item.dataset.category;
                    updateSectionTitle();
                    renderTodos();
                });
            });

            // Status filters
            document.querySelectorAll('.filter-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    document.querySelectorAll('.filter-tab').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    currentFilter.status = tab.dataset.status;
                    renderTodos();
                });
            });

            // Roadmap type filters
            document.querySelectorAll('.roadmap-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    document.querySelectorAll('.roadmap-tab').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    currentRoadmapType = tab.dataset.type;
                    renderRoadmap();
                });
            });

            // Quick add on Enter
            document.getElementById('quickAddInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') quickAdd();
            });

            // Form submit
            document.getElementById('todoForm').addEventListener('submit', handleFormSubmit);

            // Roadmap form submit
            document.getElementById('roadmapForm').addEventListener('submit', handleRoadmapFormSubmit);

            // Close modal on overlay click
            document.getElementById('modalOverlay').addEventListener('click', (e) => {
                if (e.target === e.currentTarget) closeModal();
            });

            // Close roadmap modal on overlay click
            document.getElementById('roadmapModalOverlay').addEventListener('click', (e) => {
                if (e.target === e.currentTarget) closeRoadmapModal();
            });
        }

        function updateSectionTitle() {
            const titles = {
                'all': 'Toutes les t√¢ches',
                'easynode': 'üöÄ EasyNode',
                'immobilier': 'üèØ Immobilier',
                'content': 'üì± Content',
                'personnel': 'üéã Personnel',
                'admin': 'üìÑ Admin'
            };
            document.getElementById('sectionTitle').textContent = titles[currentFilter.category] || 'Toutes les t√¢ches';
        }

        // API Functions
        async function loadTodos() {
            try {
                const response = await fetch(`${API_URL}/api/todos`);
                todos = await response.json();
                renderTodos();
                updateCategoryCounts();
            } catch (error) {
                console.error('Error loading todos:', error);
            }
        }

        async function loadStats() {
            try {
                const response = await fetch(`${API_URL}/api/stats`);
                const stats = await response.json();

                document.getElementById('statTotal').textContent = stats.total;
                document.getElementById('statPending').textContent = stats.pending;
                document.getElementById('statCompleted').textContent = stats.completed;
                document.getElementById('statOverdue').textContent = stats.overdue;
                document.getElementById('statToday').textContent = stats.today_completed;
                document.getElementById('progressPercent').textContent = `${stats.completion_rate}%`;
                document.getElementById('progressFill').style.width = `${stats.completion_rate}%`;
            } catch (error) {
                console.error('Error loading stats:', error);
            }
        }

        async function createTodo(data) {
            try {
                const response = await fetch(`${API_URL}/api/todos`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                const todo = await response.json();
                todos.unshift(todo);
                renderTodos();
                loadStats();
                updateCategoryCounts();
            } catch (error) {
                console.error('Error creating todo:', error);
            }
        }

        async function updateTodo(id, data) {
            try {
                const response = await fetch(`${API_URL}/api/todos/${id}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                const updated = await response.json();
                const index = todos.findIndex(t => t.id === id);
                if (index !== -1) todos[index] = updated;
                renderTodos();
                loadStats();
                updateCategoryCounts();
            } catch (error) {
                console.error('Error updating todo:', error);
            }
        }

        function formatDescription(description) {
            if (!description) return '';

            // Convert markdown-style formatting to HTML with emoji highlighting
            return description
                .replace(/‚è±Ô∏è/g, '<strong>‚è±Ô∏è</strong>')
                .replace(/üß≠/g, '<strong>üß≠</strong>')
                .replace(/(\d+)\./g, '<strong>$1.</strong>');
        }

        async function deleteTodo(id) {
            if (!confirm('Supprimer cette t√¢che ?')) return;

            try {
                await fetch(`${API_URL}/api/todos/${id}`, { method: 'DELETE' });
                todos = todos.filter(t => t.id !== id);
                renderTodos();
                loadStats();
                updateCategoryCounts();
            } catch (error) {
                console.error('Error deleting todo:', error);
            }
        }

        async function sendDailySummary() {
            try {
                await fetch(`${API_URL}/api/daily-summary`, { method: 'POST' });
                alert('üìä R√©sum√© envoy√© sur Telegram!');
            } catch (error) {
                console.error('Error sending summary:', error);
            }
        }

        // Render Functions
        function renderTodos() {
            const list = document.getElementById('todoList');
            let filtered = [...todos];

            // Apply filters
            if (currentFilter.status !== 'all') {
                filtered = filtered.filter(t => t.status === currentFilter.status);
            }
            if (currentFilter.category !== 'all') {
                filtered = filtered.filter(t => t.category === currentFilter.category);
            }

            if (filtered.length === 0) {
                list.innerHTML = `
                <div class="flex flex-col items-center justify-center h-64 text-center mt-4">
                    <div class="relative mb-6">
                        <div class="w-32 h-32 rounded-full bg-gradient-to-b from-transparent to-gray-100 dark:to-indigo-lighter/10 flex items-center justify-center">
                            <span class="text-6xl drop-shadow-xl animate-pulse">üóª</span>
                        </div>
                        <div class="absolute -top-2 right-0 text-xl animate-bounce" style="animation-duration: 3s;">üå∏</div>
                        <div class="absolute top-10 -left-4 text-lg animate-bounce" style="animation-duration: 4s; animation-delay: 1s;">üå∏</div>
                    </div>
                    <h3 class="text-lg font-display font-medium text-gray-700 dark:text-gray-200 mb-1">Aucune t√¢che ici!</h3>
                    <p class="text-sm text-gray-500 dark:text-gray-400 max-w-xs mx-auto">
                        L'esprit est clair comme l'eau calme.<br/>Profitez de ce moment de s√©r√©nit√©.
                    </p>
                </div>
            `;
                return;
            }

            list.innerHTML = filtered.map(todo => {
                const priorityClass = `priority-${todo.priority}`;
                const isCompleted = todo.status === 'completed';
                const categoryEmoji = {
                    'easynode': 'üöÄ',
                    'immobilier': 'üèØ',
                    'content': 'üì±',
                    'personnel': 'üéã',
                    'admin': 'üìÑ'
                }[todo.category] || 'üìã';

                let deadlineStr = '';
                if (todo.deadline) {
                    const deadline = new Date(todo.deadline);
                    deadlineStr = deadline.toLocaleDateString('fr-FR', {
                        day: 'numeric',
                        month: 'short',
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                }

                return `
                <div class="todo-item ${isCompleted ? 'completed' : ''}" data-id="${todo.id}">
                    <div class="todo-checkbox ${isCompleted ? 'checked' : ''}" onclick="toggleTodo(${todo.id}, '${todo.status}')"></div>
                    <div class="todo-content">
                        <div class="todo-title">${todo.title}</div>
                        ${todo.description ? `
                            <div class="todo-description">${formatDescription(todo.description)}</div>
                        ` : ''}
                        <div class="todo-meta">
                            <span>${categoryEmoji} ${todo.category}</span>
                            ${deadlineStr ? `<span>‚è≥ ${deadlineStr}</span>` : ''}
                        </div>
                    </div>
                    <span class="priority-badge ${priorityClass}">${todo.priority}</span>
                    <div class="todo-actions">
                        <button class="action-btn" onclick="editTodo(${todo.id})">‚úèÔ∏è</button>
                        <button class="action-btn delete" onclick="deleteTodo(${todo.id})">üóëÔ∏è</button>
                    </div>
                </div>
            `;
            }).join('');
        }

        function updateCategoryCounts() {
            const counts = {
                all: todos.filter(t => t.status === 'pending').length,
                easynode: todos.filter(t => t.category === 'easynode' && t.status === 'pending').length,
                immobilier: todos.filter(t => t.category === 'immobilier' && t.status === 'pending').length,
                content: todos.filter(t => t.category === 'content' && t.status === 'pending').length,
                personnel: todos.filter(t => t.category === 'personnel' && t.status === 'pending').length,
                admin: todos.filter(t => t.category === 'admin' && t.status === 'pending').length
            };

            document.getElementById('countAll').textContent = counts.all;
            document.getElementById('countEasynode').textContent = counts.easynode;
            document.getElementById('countImmobilier').textContent = counts.immobilier;
            document.getElementById('countContent').textContent = counts.content;
            document.getElementById('countPersonnel').textContent = counts.personnel;
            document.getElementById('countAdmin').textContent = counts.admin;
        }

        // Actions
        function toggleTodo(id, currentStatus) {
            const newStatus = currentStatus === 'completed' ? 'pending' : 'completed';
            updateTodo(id, { status: newStatus });
        }

        function quickAdd() {
            const input = document.getElementById('quickAddInput');
            const title = input.value.trim();
            if (!title) return;

            createTodo({
                title,
                category: currentFilter.category !== 'all' ? currentFilter.category : 'easynode',
                priority: 'normal'
            });
            input.value = '';
        }

        function openModal(todoId = null) {
            const modal = document.getElementById('modalOverlay');
            const form = document.getElementById('todoForm');
            const title = document.getElementById('modalTitle');

            form.reset();
            document.getElementById('todoId').value = '';

            if (todoId) {
                const todo = todos.find(t => t.id === todoId);
                if (todo) {
                    title.textContent = 'Modifier la t√¢che';
                    document.getElementById('todoId').value = todo.id;
                    document.getElementById('todoTitle').value = todo.title;
                    document.getElementById('todoDescription').value = todo.description || '';
                    document.getElementById('todoCategory').value = todo.category;
                    document.getElementById('todoPriority').value = todo.priority;
                    if (todo.deadline) {
                        document.getElementById('todoDeadline').value = todo.deadline.slice(0, 16);
                    }
                }
            } else {
                title.textContent = 'Nouvelle t√¢che';
            }

            modal.classList.add('active');
        }

        function closeModal() {
            document.getElementById('modalOverlay').classList.remove('active');
        }

        function editTodo(id) {
            openModal(id);
        }

        async function handleFormSubmit(e) {
            e.preventDefault();

            const id = document.getElementById('todoId').value;
            const data = {
                title: document.getElementById('todoTitle').value,
                description: document.getElementById('todoDescription').value,
                category: document.getElementById('todoCategory').value,
                priority: document.getElementById('todoPriority').value,
                deadline: document.getElementById('todoDeadline').value || null
            };

            if (id) {
                await updateTodo(parseInt(id), data);
            } else {
                await createTodo(data);
            }

            closeModal();
        }

        // ============== DAILY CONTENT ==============

        async function loadDailyContent() {
            try {
                const response = await fetch(`${API_URL}/api/daily-content`);
                if (response.ok) {
                    const data = await response.json();
                    document.getElementById('dailyQuote').textContent = `"${data.quote}"`;
                    document.getElementById('dailyQuoteAuthor').textContent = `‚Äî ${data.quote_author || 'Inconnu'}`;
                    document.getElementById('dailyFunFact').textContent = data.fun_fact;
                }
            } catch (error) {
                console.error('Error loading daily content:', error);
                document.getElementById('dailyQuote').textContent = '"Chaque jour est une nouvelle opportunit√©."';
                document.getElementById('dailyQuoteAuthor').textContent = '‚Äî Proverbe';
                document.getElementById('dailyFunFact').textContent = 'Le premier programme informatique a √©t√© √©crit par Ada Lovelace en 1843.';
            }
        }

        async function refreshDailyContent() {
            try {
                document.getElementById('dailyQuote').textContent = '"G√©n√©ration en cours..."';
                document.getElementById('dailyFunFact').textContent = 'G√©n√©ration en cours...';

                const response = await fetch(`${API_URL}/api/daily-content/generate`, { method: 'POST' });
                if (response.ok) {
                    const data = await response.json();
                    document.getElementById('dailyQuote').textContent = `"${data.quote}"`;
                    document.getElementById('dailyQuoteAuthor').textContent = `‚Äî ${data.quote_author || 'Inconnu'}`;
                    document.getElementById('dailyFunFact').textContent = data.fun_fact;
                }
            } catch (error) {
                console.error('Error refreshing daily content:', error);
            }
        }

        // ============== ROADMAP ==============

        async function loadRoadmap() {
            try {
                const response = await fetch(`${API_URL}/api/roadmap`);
                roadmapItems = await response.json();
                renderRoadmap();
            } catch (error) {
                console.error('Error loading roadmap:', error);
            }
        }

        function renderRoadmap() {
            const container = document.getElementById('roadmapContent');
            const filtered = roadmapItems.filter(item => item.type === currentRoadmapType);

            if (filtered.length === 0) {
                const typeLabel = currentRoadmapType === 'mid_term' ? 'mi-terme' : 'long-terme';
                container.innerHTML = `
                    <div class="flex flex-col items-center justify-center h-40 text-center">
                        <span class="text-4xl mb-3 animate-pulse">üéØ</span>
                        <p class="text-sm text-gray-500 dark:text-gray-400">Aucun objectif ${typeLabel} d√©fini. Ajoutez votre premier objectif!</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = `<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">${filtered.map(item => {
                const statusEmoji = {
                    'not_started': '‚è≥',
                    'in_progress': 'üîÑ',
                    'completed': '‚úÖ'
                }[item.status] || 'üìã';

                const statusClass = {
                    'not_started': 'bg-gray-500/20 text-gray-400',
                    'in_progress': 'bg-blue-500/20 text-blue-400',
                    'completed': 'bg-green-500/20 text-green-400'
                }[item.status] || 'bg-gray-500/20 text-gray-400';

                const targetDate = item.target_date ? new Date(item.target_date).toLocaleDateString('fr-FR', { month: 'short', year: 'numeric' }) : 'Non d√©finie';

                return `
                    <div class="glass-panel p-4 rounded-xl border border-gray-200 dark:border-white/5 hover:border-primary/30 transition-all group ${item.status === 'completed' ? 'opacity-60' : ''}">
                        <div class="flex items-start justify-between mb-2">
                            <span class="text-2xl">${item.type === 'mid_term' ? 'üìÖ' : 'üéØ'}</span>
                            <div class="flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity">
                                <button class="action-btn" onclick="editRoadmapItem(${item.id})">‚úèÔ∏è</button>
                                <button class="action-btn delete" onclick="deleteRoadmapItem(${item.id})">üóëÔ∏è</button>
                            </div>
                        </div>
                        <h4 class="font-medium text-gray-800 dark:text-white mb-1 ${item.status === 'completed' ? 'line-through' : ''}">${item.title}</h4>
                        ${item.description ? `<p class="text-xs text-gray-500 dark:text-gray-400 mb-3">${item.description}</p>` : ''}
                        <div class="flex items-center justify-between mt-3">
                            <span class="text-xs ${statusClass} px-2 py-1 rounded-full">${statusEmoji} ${item.status.replace('_', ' ')}</span>
                            <span class="text-xs text-gray-500 dark:text-gray-400">üóìÔ∏è ${targetDate}</span>
                        </div>
                    </div>
                `;
            }).join('')}</div>`;
        }

        function openRoadmapModal(itemId = null) {
            const modal = document.getElementById('roadmapModalOverlay');
            const form = document.getElementById('roadmapForm');
            const title = document.getElementById('roadmapModalTitle');

            form.reset();
            document.getElementById('roadmapItemId').value = '';
            document.getElementById('roadmapType').value = currentRoadmapType;

            if (itemId) {
                const item = roadmapItems.find(i => i.id === itemId);
                if (item) {
                    title.textContent = 'Modifier l\'objectif';
                    document.getElementById('roadmapItemId').value = item.id;
                    document.getElementById('roadmapTitle').value = item.title;
                    document.getElementById('roadmapDescription').value = item.description || '';
                    document.getElementById('roadmapType').value = item.type;
                    document.getElementById('roadmapStatus').value = item.status;
                    if (item.target_date) {
                        document.getElementById('roadmapTargetDate').value = item.target_date;
                    }
                }
            } else {
                title.textContent = 'Nouvel objectif';
            }

            modal.classList.add('active');
        }

        function closeRoadmapModal() {
            document.getElementById('roadmapModalOverlay').classList.remove('active');
        }

        function editRoadmapItem(id) {
            openRoadmapModal(id);
        }

        async function deleteRoadmapItem(id) {
            if (!confirm('Supprimer cet objectif ?')) return;

            try {
                await fetch(`${API_URL}/api/roadmap/${id}`, { method: 'DELETE' });
                roadmapItems = roadmapItems.filter(i => i.id !== id);
                renderRoadmap();
            } catch (error) {
                console.error('Error deleting roadmap item:', error);
            }
        }

        async function handleRoadmapFormSubmit(e) {
            e.preventDefault();
            console.log("Roadmap form submitted");

            // R√©cup√©rer les donn√©es
            const id = document.getElementById('roadmapItemId').value;
            const title = document.getElementById('roadmapTitle').value;
            const description = document.getElementById('roadmapDescription').value;
            const type = document.getElementById('roadmapType').value;
            const status = document.getElementById('roadmapStatus').value;
            const targetDate = document.getElementById('roadmapTargetDate').value;

            console.log("Data:", { id, title, description, type, status, targetDate });

            // Validation basique
            if (!title) {
                alert("Le titre est obligatoire");
                return;
            }

            const data = {
                title: title,
                description: description,
                type: type,
                status: status,
                target_date: targetDate || null
            };

            try {
                let response;
                if (id) {
                    console.log("Updating item", id);
                    response = await fetch(`${API_URL}/api/roadmap/${id}`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(data)
                    });
                } else {
                    console.log("Creating new item");
                    response = await fetch(`${API_URL}/api/roadmap`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(data)
                    });
                }

                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`Erreur API: ${response.status} ${errorText}`);
                }

                const result = await response.json();
                console.log("Success:", result);

                if (id) {
                    const index = roadmapItems.findIndex(i => i.id === parseInt(id));
                    if (index !== -1) roadmapItems[index] = result;
                } else {
                    roadmapItems.unshift(result);
                }

                renderRoadmap();
                closeRoadmapModal();
                // Feedback visuel
                const btn = document.querySelector('#roadmapForm button[type="submit"]');
                const originalText = btn.textContent;
                btn.textContent = "Enregistr√© !";
                setTimeout(() => btn.textContent = originalText, 2000);

            } catch (error) {
                console.error('Error saving roadmap item:', error);
                alert(`Erreur lors de l'enregistrement: ${error.message}`);
            }
        }

        // ==========================================
        // Nouvelles fonctionnalit√©s JS
        // ==========================================

        // -- Analytics & Chart.js --
        let productivityChart = null;

        async function loadAnalytics() {
            try {
                const response = await fetch(`${API_URL}/api/analytics?days=7`);
                const data = await response.json();

                // Update stats UI
                document.getElementById('streakBadge').textContent = `üî• ${data.current_streak} jours`;
                if (data.best_day) {
                    const bestDate = new Date(data.best_day.day).toLocaleDateString('fr-FR', { weekday: 'long', day: 'numeric' });
                    document.getElementById('bestDayLabel').textContent = `${bestDate} (${data.best_day.count})`;
                }

                // Render Chart
                renderChart(data.daily_stats);

                // Calculate weekly total
                const weeklyTotal = data.daily_stats.reduce((acc, curr) => acc + curr.completed, 0);
                document.getElementById('weeklyTotal').textContent = weeklyTotal;

            } catch (error) {
                console.error('Error loading analytics:', error);
            }
        }

        function renderChart(stats) {
            const ctx = document.getElementById('productivityChart').getContext('2d');

            // Prepare data
            const labels = stats.map(s => new Date(s.date).toLocaleDateString('fr-FR', { weekday: 'short' }));
            const completedData = stats.map(s => s.completed);
            const createdData = stats.map(s => s.created);

            if (productivityChart) {
                productivityChart.destroy();
            }

            productivityChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Compl√©t√©es',
                            data: completedData,
                            backgroundColor: '#D65C7C',
                            borderRadius: 4,
                            barThickness: 12
                        },
                        {
                            label: 'Cr√©√©es',
                            data: createdData,
                            backgroundColor: '#CBD5E1', // or dark mode variant
                            borderRadius: 4,
                            barThickness: 12,
                            hidden: true // hide by default to keep clean
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: '#1E293B',
                            titleColor: '#fff',
                            bodyColor: '#cbd5e1',
                            padding: 10,
                            cornerRadius: 8,
                            displayColors: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(148, 163, 184, 0.1)',
                                drawBorder: false
                            },
                            ticks: { display: false }
                        },
                        x: {
                            grid: { display: false },
                            ticks: {
                                color: '#94A3B8',
                                font: { size: 10 }
                            }
                        }
                    }
                }
            });
        }

        // -- Habitudes --
        let habits = [];

        async function loadHabits() {
            try {
                const response = await fetch(`${API_URL}/api/habits`);
                habits = await response.json();
                renderHabits();
            } catch (error) {
                console.error('Error loading habits:', error);
            }
        }

        function renderHabits() {
            const container = document.getElementById('habitsContainer');
            if (habits.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-6 text-gray-400 dark:text-gray-500">
                        <span class="text-3xl mb-2 block">üéØ</span>
                        <p class="text-xs">Aucune habitude d√©finie</p>
                    </div>`;
                return;
            }

            container.innerHTML = habits.map(habit => {
                const isDone = habit.today_completed === 1;
                return `
                <div class="flex items-center justify-between p-3 rounded-xl bg-gray-50 dark:bg-indigo-lighter/20 border border-transparent hover:border-gray-200 dark:hover:border-white/5 transition-all group">
                    <div class="flex items-center gap-3">
                        <span class="text-xl bg-white dark:bg-indigo-card p-1.5 rounded-lg shadow-sm">${habit.emoji}</span>
                        <div>
                            <div class="font-medium text-sm text-gray-800 dark:text-gray-200">${habit.name}</div>
                            <div class="text-xs text-gray-400 flex items-center gap-1">
                                <span class="material-icons-round text-[10px] text-orange-400">local_fire_department</span>
                                ${habit.streak} jours
                            </div>
                        </div>
                    </div>
                    <button onclick="toggleHabit(${habit.id})" class="w-8 h-8 rounded-full flex items-center justify-center transition-all ${isDone ? 'bg-emerald-500 text-white shadow-lg shadow-emerald-500/30' : 'bg-gray-200 dark:bg-gray-700 text-gray-400 hover:bg-gray-300 dark:hover:bg-gray-600'}">
                        <span class="material-icons-round text-lg">check</span>
                    </button>
                    <button onclick="deleteHabit(${habit.id})" class="opacity-0 group-hover:opacity-100 p-1 text-gray-400 hover:text-red-400 transition-opacity ml-2">
                        <span class="material-icons-round text-sm">close</span>
                    </button>
                </div>`;
            }).join('');
        }

        async function toggleHabit(id) {
            try {
                await fetch(`${API_URL}/api/habits/${id}/check`, { method: 'PUT' });
                // Optimistic UI update
                const habit = habits.find(h => h.id === id);
                if (habit) {
                    habit.today_completed = habit.today_completed ? 0 : 1;
                    if (habit.today_completed) habit.streak += 1;
                    else habit.streak = Math.max(0, habit.streak - 1);
                    renderHabits();
                }
                loadHabits(); // Reload for accurate data
            } catch (error) {
                console.error('Error toggling habit:', error);
            }
        }

        async function deleteHabit(id) {
            if (!confirm('Arr√™ter de suivre cette habitude ?')) return;
            try {
                await fetch(`${API_URL}/api/habits/${id}`, { method: 'DELETE' });
                habits = habits.filter(h => h.id !== id);
                renderHabits();
            } catch (error) {
                console.error('Error deleting habit:', error);
            }
        }

        // Habit Modal
        function openHabitModal() { document.getElementById('habitModalOverlay').classList.add('active'); }
        function closeHabitModal() { document.getElementById('habitModalOverlay').classList.remove('active'); }

        document.getElementById('habitForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const data = {
                name: document.getElementById('habitName').value,
                emoji: document.getElementById('habitEmoji').value,
                color: document.getElementById('habitColor').value
            };
            try {
                await fetch(`${API_URL}/api/habits`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                closeHabitModal();
                loadHabits();
                e.target.reset();
            } catch (error) {
                console.error('Error creating habit:', error);
            }
        });

        document.getElementById('habitModalOverlay').addEventListener('click', (e) => {
            if (e.target === e.currentTarget) closeHabitModal();
        });


        // -- Ma Journ√©e --
        async function loadTodayTasks() {
            try {
                const response = await fetch(`${API_URL}/api/todos/today`);
                const tasks = await response.json();
                renderTodayTasks(tasks);
                document.getElementById('todayTaskCount').textContent = `${tasks.length} t√¢ches prioritaires`;
            } catch (error) {
                console.error('Error loading today tasks:', error);
            }
        }

        function renderTodayTasks(tasks) {
            const container = document.getElementById('todayTasksContainer');
            if (tasks.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-6 text-gray-400 dark:text-gray-500">
                        <span class="text-3xl mb-2 block">üåÖ</span>
                        <p class="text-sm">Rien d'urgent pour aujourd'hui</p>
                    </div>`;
                return;
            }

            container.innerHTML = tasks.map(todo => {
                const priorityClass = `priority-${todo.priority}`;
                const time = todo.deadline ? new Date(todo.deadline).toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' }) : '';
                return `
                <div class="flex items-center gap-3 p-3 rounded-lg border border-gray-100 dark:border-white/5 bg-gray-50 dark:bg-indigo-lighter/10 hover:bg-white dark:hover:bg-indigo-lighter/20 transition-all">
                    <div class="todo-checkbox" onclick="toggleTodo(${todo.id}, '${todo.status}')"></div>
                    <div class="flex-1">
                        <div class="text-sm font-medium text-gray-800 dark:text-gray-200">${todo.title}</div>
                        <div class="text-xs text-gray-500 flex items-center gap-2 mt-0.5">
                            <span class="${priorityClass} px-1.5 py-0.5 rounded text-[10px] uppercase font-bold tracking-wider">${todo.priority}</span>
                            ${time ? `<span class="flex items-center gap-1"><span class="material-icons-round text-[10px]">schedule</span> ${time}</span>` : ''}
                        </div>
                    </div>
                </div>`;
            }).join('');
        }


        // -- Mini Calendrier --
        let currentCalDate = new Date();

        async function loadCalendar() {
            const year = currentCalDate.getFullYear();
            const month = currentCalDate.getMonth() + 1;

            // Update Label
            const monthName = currentCalDate.toLocaleDateString('fr-FR', { month: 'long', year: 'numeric' });
            document.getElementById('calendarMonthLabel').textContent = monthName.charAt(0).toUpperCase() + monthName.slice(1);

            try {
                const response = await fetch(`${API_URL}/api/calendar?year=${year}&month=${month}`);
                const data = await response.json();
                renderMiniCalendar(data);
            } catch (error) {
                console.error('Error loading calendar:', error);
            }
        }

        function renderMiniCalendar(data) {
            const container = document.getElementById('calendarDays');
            container.innerHTML = '';

            const firstDay = new Date(data.year, data.month - 1, 1).getDay(); // 0 = Dimanche
            const daysInMonth = new Date(data.year, data.month, 0).getDate();

            // Adjust for Monday start (Monday = 1, Sunday = 7)
            let startOffset = firstDay === 0 ? 6 : firstDay - 1;

            // Empty slots
            for (let i = 0; i < startOffset; i++) {
                container.innerHTML += `<div></div>`;
            }

            // Days
            for (let day = 1; day <= daysInMonth; day++) {
                const dateKey = `${data.year}-${String(data.month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const hasTask = data.tasks_by_day[dateKey];
                const isToday = new Date().toDateString() === new Date(data.year, data.month - 1, day).toDateString();

                const taskIndicator = hasTask ? `<div class="w-1 h-1 rounded-full bg-primary mx-auto mt-0.5"></div>` : '';
                const todayClass = isToday ? 'bg-primary text-white shadow-lg shadow-primary/30 font-bold' : 'text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-white/10';

                container.innerHTML += `
                    <div class="h-8 flex flex-col items-center justify-center rounded-lg cursor-pointer transition-all ${todayClass}">
                        <span class="text-xs">${day}</span>
                        ${!isToday ? taskIndicator : ''}
                    </div>
                `;
            }
        }

        function changeMonth(delta) {
            currentCalDate.setMonth(currentCalDate.getMonth() + delta);
            loadCalendar();
        }


        // Initialisation globale
        // On modifie l'initialisation existante ou on ajoute les appels
        const originalInit = window.onload; // Small hack if needed, but safe to just add listener
        document.addEventListener('DOMContentLoaded', () => {
            // Ces fonctions viennent en plus de celles d√©j√† pr√©sentes
            loadAnalytics();
            loadHabits();
            loadTodayTasks();
            loadCalendar();
        });

        // Hook dans les updates existants pour rafraichir les nouveaux widgets
        const originalCreateTodo = createTodo;
        createTodo = async function (data) {
            await originalCreateTodo(data);
            loadAnalytics();
            loadTodayTasks();
            loadCalendar();
        };

        const originalToggleTodo = window.toggleTodo; // Assuming it's global or attached
        // Note: index.html has inline onclick="toggleTodo...", so we need to ensure this hook works.
        // Actually the original toggleTodo isn't shown in the snippets but implied.
        // Let's assume we need to refresh stats when tasks change.

    </script>
</body>

</html>